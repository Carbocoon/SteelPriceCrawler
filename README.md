# 钢材数据采集助手（SteelCrawler）

这是一个基于 Streamlit 的简易爬虫前端，用于采集“好钢汇”与“91型钢”等网站的市场数据并导出为 CSV/Excel。

## 功能简介

- 启动浏览器并登录目标网站
- 在浏览器内人工登录后触发爬取指定页数的数据

## 系统要求

- Windows 10/11（64 位）
- 已安装 Chrome 浏览器（推荐与系统匹配的最新稳定版）
- 建议至少 4 GB 可用内存，网络通畅

## 运行方式

1. 将 `SteelCrawler.exe` 放在您希望运行的位置（例如桌面或某个文件夹）。
2. 双击 `SteelCrawler.exe` 启动应用，或在命令行中运行：

    ```powershell
    .\SteelCrawler.exe
    ```

3. 程序启动后会在默认浏览器中打开应用界面（通常是 `http://localhost:8501`）。如果浏览器没有自动打开，请在浏览器地址栏访问该地址。

4. 按 UI 指示进行操作：
  
   - 选择目标网站（“好钢汇” 或 “91 型钢”）；
   - 第一步：点击“启动浏览器”——程序会自动打开一个辅助的 Chrome 窗口用于登录；
   - 在打开的 Chrome 中完成人工登录并导航到目标页面，确认要爬取的总页数；
   - 第二步：回到应用界面，填写要抓取的页数并点击“开始采集”；
   - 等待采集完成，任务结束后在界面预览采集结果并通过“下载 CSV”或“下载 Excel”保存数据。

5. 若要重置并开始新任务，任务完成页底部有“🔄 开始新任务 (返回首页)”按钮，点击后会清空应用状态并返回初始界面。

## 文件保存与下载行为

- “下载 CSV/Excel”按钮会弹出系统保存对话框或由浏览器直接保存到默认下载目录，下载位置取决于浏览器或系统设置。

## 常见问题与解决方法

- 程序无法打开或被杀毒软件阻止：
  - 某些杀毒软件会误判打包的可执行文件。请在出现阻止时允许该程序运行，或将其加入白名单。

- 启动后左侧/页面空白或加载失败：
  - 请检查是否有防火墙或安全软件阻止本地端口（`8501`）。允许 `SteelCrawler.exe` 的网络访问或使用管理员权限重试。

- 浏览器窗口未打开或登录失败：
  - 请确保本机已安装 Chrome，且没有阻止弹出窗口。
  - `undetected-chromedriver` 会尝试自动下载并控制 ChromeDriver；若网络环境限制下载，请按需手动准备匹配的 `chromedriver.exe` 并将其放置在 PATH 中。

- 无法导出 Excel（导出失败或报错）：
  - 尝试先使用 CSV 导出（兼容性更好）。
  - 若打包后出现 `openpyxl` / `numpy` 等相关错误，建议使用 CSV 作为替代或联系发布者提供修复版本。
